  <div id="viewBlocks" class="hidden">
    <section class="rounded-md bg-stone-900/75 p-5 shadow-sm shadow-black/40">
      <div class="flex flex-col gap-2 sm:flex-row sm:items-baseline sm:justify-between">
        <h2 class="text-sm font-semibold uppercase tracking-wide text-stone-400">Dependency Blocks</h2>
        <p class="text-xs text-stone-500">Quick overview; hover to reveal direct dependents.</p>
      </div>
      <div class="mt-5 grid gap-3 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6">
        <% packagesView.forEach((pkg, pkgIndex) => {
          const displayName = pkg.displayName ?? pkg.name ?? `package-${pkgIndex}`;
          const pkgId = pkg.anchorId
            ?? (typeof makeId === "function"
              ? makeId(displayName)
              : displayName.replace(/[^a-zA-Z0-9-_]/g, "-"));
          const dependents = packagesView.filter((candidate, candidateIndex) => {
            const candidateDisplay = candidate.displayName ?? candidate.name ?? `package-${candidateIndex}`;
            const candidateId = candidate.anchorId
              ?? (typeof makeId === "function"
                ? makeId(candidateDisplay)
                : candidateDisplay.replace(/[^a-zA-Z0-9-_]/g, "-"));
            return candidateId !== pkgId && candidate.dependencyBadges.some((dep) => dep.anchor === pkgId);
          });
          const dependentIds = dependents.map((candidate, candidateIndex) => {
            const candidateDisplay = candidate.displayName ?? candidate.name ?? `package-${candidateIndex}`;
            return candidate.anchorId
              ?? (typeof makeId === "function"
                ? makeId(candidateDisplay)
                : candidateDisplay.replace(/[^a-zA-Z0-9-_]/g, "-"));
          });
        %>
          <article
            class="block-card relative flex min-h-[62px] flex-col justify-between gap-3 rounded-md border border-stone-800/60 bg-stone-950/70 px-4 py-3 shadow-sm shadow-black/30 transition duration-150 hover:-translate-y-0.5 hover:bg-stone-900/65"
            data-block-card
            data-pkg="<%= pkgId %>"
            data-dependents="<%= dependentIds.join(' ') %>"
            data-root="<%= pkg.isRoot ? 'true' : 'false' %>"
            tabindex="0">
            <div class="flex items-start justify-between gap-2">
              <h3 class="line-clamp-2 text-sm font-medium leading-tight text-stone-100"><%= displayName %></h3>
              <% if (pkg.isRoot) { %>
                <span class="shrink-0 rounded-sm bg-emerald-500/20 px-2 py-0.5 text-[9px] font-semibold uppercase tracking-wide text-emerald-300">Root</span>
              <% } %>
            </div>
            <div class="flex items-center gap-2">
              <% if ((pkg.undeclaredDeps?.length ?? 0) > 0) { %>
                <span class="inline-flex h-2 w-2 rounded-full bg-orange-500"></span>
              <% } %>
              <% if (pkg.cyclicCount > 0) { %>
                <span class="inline-flex h-2 w-2 rounded-full bg-red-500"></span>
              <% } %>
              <% if (dependents.length > 0) { %>
                <span class="rounded-sm bg-stone-900/70 px-2 py-0.5 text-[10px] font-semibold text-stone-300"><%= dependents.length %></span>
              <% } %>
            </div>
          </article>
        <% }); %>
      </div>
    </section>
  </div>
